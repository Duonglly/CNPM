<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>T√†i kho·∫£n c·ªßa t√¥i - M∆∞·ªùng Thanh</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
    />
    <style>
      :root {
        --primary: #c8102e;
        --primary-dark: #a00d26;
      }

      body {
        background: #f5f7fa;
        /* ƒê√£ th√™m font-family ƒë·ªÉ ∆∞u ti√™n c√°c font h·ªó tr·ª£ ti·∫øng Vi·ªát t·ªët */
        font-family: Arial, "Helvetica Neue", Helvetica, "Segoe UI", Tahoma,
          Geneva, Verdana, sans-serif;
      }

      .page-header {
        background: linear-gradient(
          135deg,
          var(--primary),
          var(--primary-dark)
        );
        color: white;
        padding: 40px 0;
        margin-bottom: 40px;
      }

      .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
      }

      .stat-card {
        background: white;
        padding: 25px;
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
        text-align: center;
        transition: transform 0.3s;
      }

      .stat-card:hover {
        transform: translateY(-3px);
      }

      .stat-icon {
        font-size: 30px;
        color: var(--primary);
        margin-bottom: 10px;
      }

      .stat-card h3 {
        font-size: 28px;
        font-weight: 700;
        color: var(--primary-dark);
        margin-bottom: 5px;
      }

      .stat-card p {
        color: #6c757d;
        font-size: 14px;
        margin: 0;
      }

      .account-section {
        background: white;
        padding: 30px;
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
      }

      .nav-pills .nav-link.active {
        background-color: var(--primary) !important;
      }

      .form-group label {
        font-weight: 600;
        color: #495057;
      }
    </style>
  </head>
  <body>
    <div class="page-header">
      <div class="container">
        <h1>
          <i class="fas fa-user-circle"></i> T√†i kho·∫£n c·ªßa t√¥i
          <span class="fs-5 d-block mt-1">Ch√†o m·ª´ng, {{ user.full_name }}</span>
        </h1>
      </div>
    </div>

    <div class="container">
      <h2 class="mb-3 text-secondary">Th·ªëng k√™ ƒë·∫∑t ph√≤ng üìä</h2>
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-icon"><i class="fas fa-book"></i></div>
          <h3>{{ stats.total_bookings }}</h3>
          <p>T·ªïng s·ªë l·∫ßn ƒë·∫∑t</p>
        </div>
        <div class="stat-card">
          <div class="stat-icon" style="color: #28a745">
            <i class="fas fa-check-circle"></i>
          </div>
          <h3>{{ stats.completed_bookings }}</h3>
          <p>ƒê∆°n ƒë√£ ho√†n th√†nh</p>
        </div>
        <div class="stat-card">
          <div class="stat-icon" style="color: #dc3545">
            <i class="fas fa-times-circle"></i>
          </div>
          <h3>{{ stats.cancelled_bookings }}</h3>
          <p>ƒê∆°n ƒë√£ h·ªßy</p>
        </div>
        <div class="stat-card">
          <div class="stat-icon"><i class="fas fa-wallet"></i></div>
          <h3>{{ stats.total_spent | format_currency }}</h3>
          <p>T·ªïng chi ti√™u</p>
        </div>
      </div>
      <div class="account-section">
        <ul class="nav nav-pills mb-3" role="tablist">
          <li class="nav-item" role="presentation">
            <button
              class="nav-link active"
              id="info-tab"
              data-bs-toggle="pill"
              data-bs-target="#info"
              type="button"
              role="tab"
              aria-controls="info"
              aria-selected="true"
            >
              <i class="fas fa-user me-2"></i>Th√¥ng tin c√° nh√¢n
            </button>
          </li>
          <li class="nav-item" role="presentation">
            <button
              class="nav-link"
              id="update-tab"
              data-bs-toggle="pill"
              data-bs-target="#update"
              type="button"
              role="tab"
              aria-controls="update"
              aria-selected="false"
            >
              <i class="fas fa-edit me-2"></i>C·∫≠p nh·∫≠t & B·∫£o m·∫≠t
            </button>
          </li>
          <li class="nav-item" role="presentation">
            <a
              class="nav-link"
              href="{{ url_for('my_bookings') }}"
              style="color: var(--primary)"
            >
              <i class="fas fa-clipboard-list me-2"></i>L·ªãch s·ª≠ ƒë·∫∑t ph√≤ng
            </a>
          </li>
        </ul>
        <hr />

        <div class="tab-content">
          <div
            class="tab-pane fade show active"
            id="info"
            role="tabpanel"
            aria-labelledby="info-tab"
          >
            <h4 class="mb-4 text-primary">Chi ti·∫øt h·ªì s∆°</h4>
            <div class="row">
              <div class="col-md-6 mb-3">
                <label class="form-label">H·ªç v√† t√™n</label>
                <p class="form-control-plaintext fw-bold">
                  {{ user.full_name }}
                </p>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Email</label>
                <p class="form-control-plaintext">{{ user.email }}</p>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">S·ªë ƒëi·ªán tho·∫°i</label>
                <p class="form-control-plaintext">
                  {{ user.phone if user.phone else 'Ch∆∞a c·∫≠p nh·∫≠t' }}
                </p>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">ƒê·ªãa ch·ªâ</label>
                <p class="form-control-plaintext">
                  {{ user.address if user.address else 'Ch∆∞a c·∫≠p nh·∫≠t' }}
                </p>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Lo·∫°i t√†i kho·∫£n</label>
                <p class="form-control-plaintext text-capitalize">
                  {{ user.role | capitalize }}
                </p>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Ng√†y tham gia</label>
                <p class="form-control-plaintext">
                  {{ user.created_at.strftime('%d/%m/%Y') }}
                </p>
              </div>
            </div>
            <button
              type="button"
              class="btn btn-primary mt-3"
              data-bs-toggle="modal"
              data-bs-target="#changePasswordModal"
            >
              <i class="fas fa-lock me-2"></i>ƒê·ªïi m·∫≠t kh·∫©u
            </button>
          </div>

          <div
            class="tab-pane fade"
            id="update"
            role="tabpanel"
            aria-labelledby="update-tab"
          >
            <h4 class="mb-4 text-primary">C·∫≠p nh·∫≠t th√¥ng tin</h4>
            <form
              method="POST"
              action="{{ url_for('update_account') }}"
              class="row g-3"
            >
              <div class="col-md-6">
                <label for="full_name" class="form-label">H·ªç v√† t√™n</label>
                <input
                  type="text"
                  class="form-control"
                  id="full_name"
                  name="full_name"
                  value="{{ user.full_name }}"
                  required
                />
              </div>
              <div class="col-md-6">
                <label for="email" class="form-label">Email (Kh√¥ng ƒë·ªïi)</label>
                <input
                  type="email"
                  class="form-control"
                  id="email"
                  value="{{ user.email }}"
                  disabled
                />
              </div>
              <div class="col-md-6">
                <label for="phone" class="form-label">S·ªë ƒëi·ªán tho·∫°i</label>
                <input
                  type="text"
                  class="form-control"
                  id="phone"
                  name="phone"
                  value="{{ user.phone if user.phone else '' }}"
                />
              </div>
              <div class="col-12">
                <label for="address" class="form-label">ƒê·ªãa ch·ªâ</label>
                <input
                  type="text"
                  class="form-control"
                  id="address"
                  name="address"
                  value="{{ user.address if user.address else '' }}"
                />
              </div>
              <div class="col-12 mt-4">
                <button type="submit" class="btn btn-primary">
                  L∆∞u thay ƒë·ªïi
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

    <div
      class="modal fade"
      id="changePasswordModal"
      tabindex="-1"
      aria-labelledby="changePasswordModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="changePasswordModalLabel">
              <i class="fas fa-lock me-2"></i>ƒê·ªïi m·∫≠t kh·∫©u
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <form method="POST" action="{{ url_for('change_password') }}">
            <div class="modal-body">
              <div class="mb-3">
                <label class="form-label">M·∫≠t kh·∫©u hi·ªán t·∫°i</label>
                <input
                  type="password"
                  name="current_password"
                  class="form-control"
                  required
                />
              </div>
              <div class="mb-3">
                <label class="form-label">M·∫≠t kh·∫©u m·ªõi</label>
                <input
                  type="password"
                  name="new_password"
                  class="form-control"
                  minlength="6"
                  required
                />
                <small class="text-muted">T·ªëi thi·ªÉu 6 k√Ω t·ª±</small>
              </div>
              <div class="mb-3">
                <label class="form-label">X√°c nh·∫≠n m·∫≠t kh·∫©u m·ªõi</label>
                <input
                  type="password"
                  name="confirm_password"
                  class="form-control"
                  required
                />
              </div>
            </div>
            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-secondary"
                data-bs-dismiss="modal"
              >
                H·ªßy
              </button>
              <button type="submit" class="btn btn-danger">ƒê·ªïi m·∫≠t kh·∫©u</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
